cscope 15 $HOME/ds_ana/solution/ch05 -q 0000000080 0000009195
	@fatal.h

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

4 
	#E¼Ü
Ğ
SŒ
 ) 
	`F©®E¼Ü
ĞSŒ )

	)

5 
	#F©®E¼Ü
Ğ
SŒ
 ) 
	`årštf
Ğ
¡d”r
, "%s\n", SŒ ), 
	`ex™
Ğ1 )

	)

	@hashfunc.c

4 
	tIndex
;

7 
Index


8 
	$Hash1
ĞcÚ¡ *
Key
, 
TabËSize
 )

10 
HashV®
 = 0;

12   *
Key
 != '\0' )

13  
HashV®
 +ğ*
Key
++;

15   
HashV®
 % 
TabËSize
;

16 
	}
}

20 
Index


21 
	$Hash2
ĞcÚ¡ *
Key
, 
TabËSize
 )

23  ( 
Key
[ 0 ] + 27 * Key[ 1 ] + 729 * Key[ 2 ] )

24 % 
TabËSize
;

25 
	}
}

29 
Index


30 
	$Hash3
ĞcÚ¡ *
Key
, 
TabËSize
 )

32 
HashV®
 = 0;

34   *
Key
 != '\0' )

35  
HashV®
 = ( HashV® << 5 ) + *
Key
++;

37   
HashV®
 % 
TabËSize
;

38 
	}
}

	@hashquad.c

1 
	~"çl.h
"

2 
	~"hashquad.h
"

3 
	~<¡dlib.h
>

5 
	#MšTabËSize
 (10)

	)

7 
	eKšdOfEÁry
 { 
	mLeg™im©e
, 
	mEm±y
, 
	mD–‘ed
 };

9 
	sHashEÁry


11 
EËm’tTy³
 
	mEËm’t
;

12 
KšdOfEÁry
 
	mInfo
;

15 
HashEÁry
 
	tC–l
;

19 
	sHashTbl


21 
	mTabËSize
;

22 
C–l
 *
	mTheC–ls
;

28 
	$NextPrime
Ğ
N
 )

30 
i
;

32 ifĞ
N
 % 2 == 0 )

33 
N
++;

34  ; ; 
N
 += 2 )

36  
i
 = 3; i * i <ğ
N
; i += 2 )

37 ifĞ
N
 % 
i
 == 0 )

38 
CÚtOu‹r
;

39  
N
;

40 
CÚtOu‹r
: ;

42 
	}
}

45 
Index


46 
	$Hash
Ğ
EËm’tTy³
 
Key
, 
TabËSize
 )

48  
Key
 % 
TabËSize
;

49 
	}
}

52 
HashTabË


53 
	$In™ŸlizeTabË
Ğ
TabËSize
 )

55 
HashTabË
 
H
;

56 
i
;

58  ifĞ
TabËSize
 < 
MšTabËSize
 )

60  
	`E¼Ü
( "Table sizeoo small" );

61   
NULL
;

65  
H
 = 
	`m®loc
ĞĞ
HashTbl
 ) );

66  ifĞ
H
 =ğ
NULL
 )

67  
	`F©®E¼Ü
( "Out of space!!!" );

69  
H
->
TabËSize
 = 
	`NextPrime
( TableSize );

72  
H
->
TheC–ls
 = 
	`m®loc
ĞĞ
C–l
 ) * H->
TabËSize
 );

73  ifĞ
H
->
TheC–ls
 =ğ
NULL
 )

74  
	`F©®E¼Ü
( "Out of space!!!" );

76   
i
 = 0; i < 
H
->
TabËSize
; i++ )

77  
H
->
TheC–ls
[ 
i
 ].
Info
 = 
Em±y
;

79   
H
;

80 
	}
}

84 
Pos™iÚ


85 
	$Fšd
Ğ
EËm’tTy³
 
Key
, 
HashTabË
 
H
 )

87 
Pos™iÚ
 
Cu¼’tPos
;

88 
CŞlisiÚNum
;

90  
CŞlisiÚNum
 = 0;

91  
Cu¼’tPos
 = 
	`Hash
Ğ
Key
, 
H
->
TabËSize
 );

92   
H
->
TheC–ls
[ 
Cu¼’tPos
 ].
Info
 !ğ
Em±y
 &&

93 
H
->
TheC–ls
[ 
Cu¼’tPos
 ].
EËm’t
 !ğ
Key
 )

96  
Cu¼’tPos
 +ğ2 * ++
CŞlisiÚNum
 - 1;

97  ifĞ
Cu¼’tPos
 >ğ
H
->
TabËSize
 )

98  
Cu¼’tPos
 -ğ
H
->
TabËSize
;

100   
Cu¼’tPos
;

101 
	}
}

106 
	$In£¹
Ğ
EËm’tTy³
 
Key
, 
HashTabË
 
H
 )

108 
Pos™iÚ
 
Pos
;

110 
Pos
 = 
	`Fšd
Ğ
Key
, 
H
 );

111 ifĞ
H
->
TheC–ls
[ 
Pos
 ].
Info
 !ğ
Leg™im©e
 )

114 
H
->
TheC–ls
[ 
Pos
 ].
Info
 = 
Leg™im©e
;

115 
H
->
TheC–ls
[ 
Pos
 ].
EËm’t
 = 
Key
;

118 
	}
}

122 
HashTabË


123 
	$Rehash
Ğ
HashTabË
 
H
 )

125 
i
, 
OldSize
;

126 
C–l
 *
OldC–ls
;

128  
OldC–ls
 = 
H
->
TheC–ls
;

129  
OldSize
 = 
H
->
TabËSize
;

132  
H
 = 
	`In™ŸlizeTabË
Ğ2 * 
OldSize
 );

135   
i
 = 0; i < 
OldSize
; i++ )

136  ifĞ
OldC–ls
[ 
i
 ].
Info
 =ğ
Leg™im©e
 )

137  
	`In£¹
Ğ
OldC–ls
[ 
i
 ].
EËm’t
, 
H
 );

139  
	`ä“
Ğ
OldC–ls
 );

141   
H
;

142 
	}
}

147 
EËm’tTy³


148 
	$R‘r›ve
Ğ
Pos™iÚ
 
P
, 
HashTabË
 
H
 )

150  
H
->
TheC–ls
[ 
P
 ].
EËm’t
;

151 
	}
}

154 
	$De¡royTabË
Ğ
HashTabË
 
H
 )

156 
	`ä“
Ğ
H
->
TheC–ls
 );

157 
	`ä“
Ğ
H
 );

158 
	}
}

	@hashquad.h

2 
	tEËm’tTy³
;

5 #iâdeà
_HashQuad_H


6 
	#_HashQuad_H


	)

8 
	tIndex
;

9 
Index
 
	tPos™iÚ
;

11 
	gHashTbl
;

12 
HashTbl
 *
	tHashTabË
;

14 
HashTabË
 
In™ŸlizeTabË
Ğ
TabËSize
 );

15 
De¡royTabË
Ğ
HashTabË
 
H
 );

16 
Pos™iÚ
 
Fšd
Ğ
EËm’tTy³
 
Key
, 
HashTabË
 
H
 );

17 
In£¹
Ğ
EËm’tTy³
 
Key
, 
HashTabË
 
H
 );

18 
EËm’tTy³
 
R‘r›ve
Ğ
Pos™iÚ
 
P
, 
HashTabË
 
H
 );

19 
HashTabË
 
Rehash
ĞHashTabË 
H
 );

	@hashsep.c

1 
	~"çl.h
"

2 
	~"hash£p.h
"

3 
	~<¡dlib.h
>

5 
	#MšTabËSize
 (10)

	)

7 
	sLi¡Node


9 
EËm’tTy³
 
	mEËm’t
;

10 
Pos™iÚ
 
	mNext
;

13 
Pos™iÚ
 
	tLi¡
;

18 
	sHashTbl


20 
	mTabËSize
;

21 
Li¡
 *
	mTheLi¡s
;

26 
	$NextPrime
Ğ
N
 )

28 
i
;

30 ifĞ
N
 % 2 == 0 )

31 
N
++;

32  ; ; 
N
 += 2 )

34  
i
 = 3; i * i <ğ
N
; i += 2 )

35 ifĞ
N
 % 
i
 == 0 )

36 
CÚtOu‹r
;

37  
N
;

38 
CÚtOu‹r
: ;

40 
	}
}

43 
Index


44 
	$Hash
Ğ
EËm’tTy³
 
Key
, 
TabËSize
 )

46  
Key
 % 
TabËSize
;

47 
	}
}

50 
HashTabË


51 
	$In™ŸlizeTabË
Ğ
TabËSize
 )

53 
HashTabË
 
H
;

54 
i
;

56  ifĞ
TabËSize
 < 
MšTabËSize
 )

58  
	`E¼Ü
( "Table sizeoo small" );

59   
NULL
;

63  
H
 = 
	`m®loc
ĞĞ
HashTbl
 ) );

64  ifĞ
H
 =ğ
NULL
 )

65  
	`F©®E¼Ü
( "Out of space!!!" );

67  
H
->
TabËSize
 = 
	`NextPrime
( TableSize );

70  
H
->
TheLi¡s
 = 
	`m®loc
ĞĞ
Li¡
 ) * H->
TabËSize
 );

71  ifĞ
H
->
TheLi¡s
 =ğ
NULL
 )

72  
	`F©®E¼Ü
( "Out of space!!!" );

75   
i
 = 0; i < 
H
->
TabËSize
; i++ )

77  
H
->
TheLi¡s
[ 
i
 ] = 
	`m®loc
ĞĞ
Li¡Node
 ) );

78  ifĞ
H
->
TheLi¡s
[ 
i
 ] =ğ
NULL
 )

79  
	`F©®E¼Ü
( "Out of space!!!" );

81  
H
->
TheLi¡s
[ 
i
 ]->
Next
 = 
NULL
;

84   
H
;

85 
	}
}

89 
Pos™iÚ


90 
	$Fšd
Ğ
EËm’tTy³
 
Key
, 
HashTabË
 
H
 )

92 
Pos™iÚ
 
P
;

93 
Li¡
 
L
;

95  
L
 = 
H
->
TheLi¡s
[ 
	`Hash
Ğ
Key
, H->
TabËSize
 ) ];

96  
P
 = 
L
->
Next
;

97   
P
 !ğ
NULL
 && P->
EËm’t
 !ğ
Key
 )

99  
P
 = P->
Next
;

100   
P
;

101 
	}
}

106 
	$In£¹
Ğ
EËm’tTy³
 
Key
, 
HashTabË
 
H
 )

108 
Pos™iÚ
 
Pos
, 
NewC–l
;

109 
Li¡
 
L
;

111  
Pos
 = 
	`Fšd
Ğ
Key
, 
H
 );

112  ifĞ
Pos
 =ğ
NULL
 )

114  
NewC–l
 = 
	`m®loc
ĞĞ
Li¡Node
 ) );

115  ifĞ
NewC–l
 =ğ
NULL
 )

116  
	`F©®E¼Ü
( "Out of space!!!" );

119  
L
 = 
H
->
TheLi¡s
[ 
	`Hash
Ğ
Key
, H->
TabËSize
 ) ];

120  
NewC–l
->
Next
 = 
L
->Next;

121  
NewC–l
->
EËm’t
 = 
Key
;

122  
L
->
Next
 = 
NewC–l
;

125 
	}
}

128 
EËm’tTy³


129 
	$R‘r›ve
Ğ
Pos™iÚ
 
P
 )

131  
P
->
EËm’t
;

132 
	}
}

135 
	$De¡royTabË
Ğ
HashTabË
 
H
 )

137 
i
;

139  
i
 = 0; i < 
H
->
TabËSize
; i++ )

141 
Pos™iÚ
 
P
 = 
H
->
TheLi¡s
[ 
i
 ];

142 
Pos™iÚ
 
Tmp
;

144  
P
 !ğ
NULL
 )

146 
Tmp
 = 
P
->
Next
;

147 
	`ä“
Ğ
P
 );

148 
P
 = 
Tmp
;

152 
	`ä“
Ğ
H
->
TheLi¡s
 );

153 
	`ä“
Ğ
H
 );

154 
	}
}

	@hashsep.h

2 
	tEËm’tTy³
;

5 
	tIndex
;

9 #iâdeà
_HashS•_H


10 
	#_HashS•_H


	)

12 
	gLi¡Node
;

13 
Li¡Node
 *
	tPos™iÚ
;

14 
	gHashTbl
;

15 
HashTbl
 *
	tHashTabË
;

17 
HashTabË
 
In™ŸlizeTabË
Ğ
TabËSize
 );

18 
De¡royTabË
Ğ
HashTabË
 
H
 );

19 
Pos™iÚ
 
Fšd
Ğ
EËm’tTy³
 
Key
, 
HashTabË
 
H
 );

20 
In£¹
Ğ
EËm’tTy³
 
Key
, 
HashTabË
 
H
 );

21 
EËm’tTy³
 
R‘r›ve
Ğ
Pos™iÚ
 
P
 );

	@main.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~"hash£p.h
"

5 
	#EMPTY
 (-1)

	)

8 
Index
 
	$Hash
Ğ
EËm’tTy³
 
Key
, 
TabËSize
)

10  
Key
 % 
TabËSize
;

11 
	}
}

14 
Index
 
	$Lš—rHash
(
EËm’tTy³
 
Key
, 
cŞlisiÚ
, 
TabËSize
)

16  (
	`Hash
(
Key
, 
TabËSize
è+ 
cŞlisiÚ
) % TableSize;

17 
	}
}

20 
Index
 
	$Lš—rIn£¹
(
EËm’tTy³
 
Key
, 
A
[], 
TabËSize
)

22 
c
 = 0, 
idx
;

24 
idx
 = 
	`Hash
(
Key
, 
TabËSize
);

25 
A
[
idx
] !ğ
EMPTY
)

26 
idx
 = 
	`Lš—rHash
(
Key
, ++
c
, 
TabËSize
);

27 
A
[
idx
] = 
Key
;

29  
idx
;

30 
	}
}

32 
Index
 
	$QuadHash
(
EËm’tTy³
 
Key
, 
cŞlisiÚ
, 
TabËSize
)

34  (
	`Hash
(
Key
, 
TabËSize
è+ 
cŞlisiÚ
 * collision) % TableSize;

35 
	}
}

37 
Index
 
	$QuadIn£¹
(
EËm’tTy³
 
Key
, 
A
[], 
TabËSize
)

39 
c
 = 0, 
idx
;

41 
idx
 = 
	`Hash
(
Key
, 
TabËSize
);

42 
A
[
idx
] !ğ
EMPTY
)

43 
idx
 = 
	`QuadHash
(
Key
, ++
c
, 
TabËSize
);

44 
A
[
idx
] = 
Key
;

46  
idx
;

47 
	}
}

49 
Index
 
	$SecÚdHash
(
EËm’tTy³
 
Key
, 
cŞlisiÚ
, 
TabËSize
)

51  (
	`Hash
(
Key
, 
TabËSize
è+ 
cŞlisiÚ
 * (7 - (Key % 7))) % TableSize;

52 
	}
}

54 
Index
 
	$SecÚdIn£¹
(
EËm’tTy³
 
Key
, 
A
[], 
TabËSize
)

56 
c
 = 0, 
idx
;

58 
idx
 = 
	`Hash
(
Key
, 
TabËSize
);

59 
A
[
idx
] !ğ
EMPTY
)

60 
idx
 = 
	`QuadHash
(
Key
, ++
c
, 
TabËSize
);

61 
A
[
idx
] = 
Key
;

63  
idx
;

64 
	}
}

68 
	$maš
(
¬gc
, *
¬gv
[])

70 
i
, 
A
[7] = {4371, 1323, 6173, 4199, 4344, 9679, 1989};

71 
H
[10];

73 
i
 = 0; i < 10; ++i)

74 
H
[
i
] = 
EMPTY
;

76 
	`´štf
("Separate Chaining: ");

77 
i
 = 0; i < 7; ++i)

78 
	`´štf
("%u ", 
	`Hash
(
A
[
i
], 10));

79 
	`´štf
("\n");

81 
	`´štf
("linear…robing:");

82 
i
 = 0; i < 7; ++i)

83 
	`´štf
("%u ", 
	`Lš—rIn£¹
(
A
[
i
], 
H
, 10));

84 
	`´štf
("\n");

86 
i
 = 0; i < 10; ++i)

87 
H
[
i
] = 
EMPTY
;

89 
	`´štf
("quadratic…robing:");

90 
i
 = 0; i < 7; ++i)

91 
	`´štf
("%u ", 
	`QuadIn£¹
(
A
[
i
], 
H
, 10));

93 
	`´štf
("\n");

95 
i
 = 0; i < 10; ++i)

96 
H
[
i
] = 
EMPTY
;

98 
	`´štf
("Second hash:");

99 
i
 = 0; i < 7; ++i)

100 
	`´štf
("%u ", 
	`SecÚdIn£¹
(
A
[
i
], 
H
, 10));

102 
	`´štf
("\n");

105 
	}
}

	@next_prime.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

4 
	$NextPrime
Ğ
N
 )

6 
i
;

8 ià(++
N
 % 2 == 0)

9 ++
N
;

11  ; ; 
N
 += 2 ) {

12  
i
 = 3; i * i <ğ
N
; i += 2 )

13 iàĞ
N
 % 
i
 == 0 )

14 
CÚtOu‹r
;

15  
N
;

16 
CÚtOu‹r
: ;

18 
	}
}

20 
	$CheckPrime
Ğ
N
 )

23 
	}
}

26 
	$PrštPrime
(
N
)

28 
i
 = 2;

30 
i
 < 
N
) {

31 
	`´štf
("%u ", 
i
);

32 
i
 = 
	`NextPrime
(i);

34 
	`´štf
("\n");

35 
	}
}

37 
	$maš
(
¬gc
, *
¬gv
[])

39 
i
, 
N
;

41 ià(
¬gc
 != 2) {

42 
	`´štf
("Usage: ./test <NUM>\n");

45 
N
 = 
	`¡¹oul
(
¬gv
[1], 
NULL
, 0);

47 
	`PrštPrime
(
N
);

50 
	}
}

	@
1
.
0
8
81
fatal.h
hashfunc.c
hashquad.c
hashquad.h
hashsep.c
hashsep.h
main.c
next_prime.c
